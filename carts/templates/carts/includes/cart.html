{% load static %}
{% load humanize %}
<div class="aside aside_right overflow-hidden cart-drawer" id="cartDrawer">
  <div class="aside-header d-flex align-items-center">
    <h3 class="text-uppercase fs-6 mb-0">
      SHOPPING BAG ( <span class="cart-amount js-cart-items-count">{{cart_items|length}}</span> )
    </h3>
    <button class="btn-close-lg js-close-aside btn-close-aside ms-auto"></button>
  </div>
  <!-- /.aside-header -->

  <div class="aside-content cart-drawer-items-list">
    {% if cart_items %}
      {% for cart_item in cart_items %}
        <div class="cart-drawer-item d-flex position-relative">
          <div class="position-relative">
            <a href="product-details.html">
              {% if cart_item.product.product_image %}
                <img
                  loading="lazy"
                  class="cart-drawer-item__img"
                  src="{{ cart_item.product.product_image.url }}"
                  alt="{{ cart_item.product.product_name }}"
                />
              {% else %}
                <img
                  loading="lazy"
                  class="cart-drawer-item__img"
                  src="{% static 'abdellah_shoping/images/default-product.jpg' %}"
                  alt="No image"
                />
              {% endif %}
            </a>
          </div>
          <div class="cart-drawer-item__info flex-grow-1">
            <h6 class="cart-drawer-item__title fw-normal">
              <a href="product-details.html">{{ cart_item.product.product_name }}</a>
            </h6>
            <p class="cart-drawer-item__option text-secondary">Size: {{cart_item.size}}</p>
            <div class="d-flex align-items-center justify-content-between mt-1">
              <div class="qty-control position-relative">
                <input
                  type="number"
                  name="quantity"
                  value="{{ cart_item.quantity }}"
                  min="1"
                  class="qty-control__number border-0 text-center"
                />
                <div class="qty-control__reduce text-start">-</div>
                <div class="qty-control__increase text-end">+</div>
              </div>
              <!-- .qty-control -->
              <span class="cart-drawer-item__price money price">
                ${{ cart_item.sub_total|floatformat:2|intcomma }}
              </span>
            </div>
          </div>

          <button class="btn-close-xs position-absolute top-0 end-0 js-cart-item-remove"></button>
        </div>
        <!-- /.cart-drawer-item -->

        {% if not forloop.last %}
          <hr class="cart-drawer-divider" />
        {% endif %}
      {% endfor %}
    {% else %}
      <p>There are No Products in Your cart</p>
    {% endif %}
  </div>
  <!-- /.aside-content -->

  <div class="cart-drawer-actions position-absolute start-0 bottom-0 w-100">
    <hr class="cart-drawer-divider" />
    <div class="d-flex justify-content-between">
      <h6 class="fs-base fw-medium">SUBTOTAL:</h6>
      <span class="cart-subtotal fw-medium">${{ total|floatformat:2|intcomma }}</span>
    </div>
    <!-- /.d-flex justify-content-between -->
    <a href="{% url 'carts_urls:view_cart_page' %}" class="btn btn-light mt-3 d-block">View Cart</a>
    <a href="shop_checkout.html" class="btn btn-primary mt-3 d-block">Checkout</a>
  </div>
  <!-- /.aside-content -->
</div>
<!-- /.aside -->
